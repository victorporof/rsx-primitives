<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `parallel` mod in crate `style`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, parallel">

    <title>style::parallel - Rust</title>

    <link rel="stylesheet" type="text/css" href="../../normalize.css">
    <link rel="stylesheet" type="text/css" href="../../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../../main.css">
    

    
    
</head>
<body class="rustdoc mod">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'>Module parallel</p><div class="block items"><ul><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#functions">Functions</a></li></ul></div><p class='location'><a href='../index.html'>style</a></p><script>window.sidebarCurrent = {name: 'parallel', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content">
<h1 class='fqn'><span class='in-band'>Module <a href='../index.html'>style</a>::<wbr><a class="mod" href=''>parallel</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a class='srclink' href='../../src/style/parallel.rs.html#5-290' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>Implements parallel traversal over the DOM tree.</p>

<p>This traversal is based on Rayon, and therefore its safety is largely
verified by the type system.</p>

<p>The primary trickiness and fine print for the above relates to the
thread safety of the DOM nodes themselves. Accessing a DOM element
concurrently on multiple threads is actually mostly &quot;safe&quot;, since all
the mutable state is protected by an AtomicRefCell, and so we&#39;ll
generally panic if something goes wrong. Still, we try to to enforce our
thread invariants at compile time whenever possible. As such, TNode and
TElement are not Send, so ordinary style system code cannot accidentally
share them with other threads. In the parallel traversal, we explicitly
invoke |unsafe { SendNode::new(n) }| to put nodes in containers that may
be sent to other threads. This occurs in only a handful of places and is
easy to grep for. At the time of this writing, there is no other unsafe
code in the parallel traversal.</p>
</div><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class="enum" href="enum.DispatchMode.html"
                                  title='enum style::parallel::DispatchMode'>DispatchMode</a></td>
                           <td class='docblock-short'>
                                <p>Controls whether traverse_nodes may make a recursive call to continue
doing work, or whether it should always dispatch work asynchronously.</p>
                           </td>
                       </tr></table><h2 id='constants' class='section-header'><a href="#constants">Constants</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class="constant" href="constant.STACK_SAFETY_MARGIN_KB.html"
                                  title='constant style::parallel::STACK_SAFETY_MARGIN_KB'>STACK_SAFETY_MARGIN_KB</a></td>
                           <td class='docblock-short'>
                                <p>The stack margin. If we get this deep in the stack, we will skip recursive
optimizations to ensure that there is sufficient room for non-recursive work.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class="constant" href="constant.STYLE_THREAD_STACK_SIZE_KB.html"
                                  title='constant style::parallel::STYLE_THREAD_STACK_SIZE_KB'>STYLE_THREAD_STACK_SIZE_KB</a></td>
                           <td class='docblock-short'>
                                <p>The minimum stack size for a thread in the styling pool, in kilobytes.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class="constant" href="constant.WORK_UNIT_MAX.html"
                                  title='constant style::parallel::WORK_UNIT_MAX'>WORK_UNIT_MAX</a></td>
                           <td class='docblock-short'>
                                <p>The maximum number of child nodes that we will process as a single unit.</p>
                           </td>
                       </tr></table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class="fn" href="fn.traverse_nodes.html"
                                  title='fn style::parallel::traverse_nodes'>traverse_nodes</a></td>
                           <td class='docblock-short'>
                                <p>Enqueues |nodes| for processing, possibly on this thread if the tail call
conditions are met.</p>
                           </td>
                       </tr></table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>↑</dt>
                    <dd>Move up in search results</dd>
                    <dt>↓</dt>
                    <dd>Move down in search results</dd>
                    <dt>↹</dt>
                    <dd>Switch tab</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt style="width:31px;">+ / -</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../../";
        window.currentCrate = "style";
    </script>
    <script src="../../main.js"></script>
    <script defer src="../../search-index.js"></script>
</body>
</html>